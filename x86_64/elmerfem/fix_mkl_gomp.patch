--- cmake/Modules/FindMKL.cmake	2020-11-10 19:52:44.000000000 +0000
+++ cmake/Modules/FindMKL.cmake.new	2024-08-07 18:59:02.546972893 +0100
@@ -105,6 +105,7 @@
 ELSE()
   SET(MKL_THREAD_LIB_NAME "mkl_sequential" INTERNAL)
 ENDIF()
+SET(MKL_GOMP_LIB_NAME "gomp" INTERNAL)
 SET(MKL_PTHREAD_LIB_NAME "pthread" INTERNAL)
 SET(MKL_M_LIB_NAME "m" INTERNAL)
 
@@ -119,23 +120,26 @@
 FIND_LIBRARY(MKL_CORE_LIB ${MKL_CORE_LIB_NAME} HINTS ${MKLLIB})
 FIND_LIBRARY(MKL_NUM_LIB ${MKL_NUM_LIB_NAME} HINTS ${MKLLIB})
 FIND_LIBRARY(MKL_THREAD_LIB ${MKL_THREAD_LIB_NAME} HINTS ${MKLLIB})
+FIND_LIBRARY(MKL_GOMP_LIB ${MKL_GOMP_LIB_NAME} HINTS ${MKLLIB})
 FIND_LIBRARY(MKL_PTHREAD_LIB ${MKL_PTHREAD_LIB_NAME} HINTS ${MKLLIB})
 FIND_LIBRARY(MKL_M_LIB ${MKL_M_LIB_NAME} HINTS ${MKLLIB})
 
 IF (MKL_INCLUDE_DIR AND MKL_CORE_LIB AND 
     MKL_NUM_LIB AND MKL_THREAD_LIB AND 
-    MKL_PTHREAD_LIB AND MKL_M_LIB)
+    MKL_GOMP_LIB AND MKL_PTHREAD_LIB AND MKL_M_LIB)
   UNSET(MKL_FAILMSG)
   # SET(MKL_FOUND TRUE)
   SET(MKL_BLAS_LIBRARIES ${MKL_NUM_LIB} 
                          ${MKL_THREAD_LIB}
 			 ${MKL_CORE_LIB} 
+                         ${MKL_GOMP_LIB}
                          ${MKL_PTHREAD_LIB}
                          ${MKL_M_LIB}  CACHE FILEPATH "MKL BLAS")
   SET(MKL_BLAS_LIBRARIES_FOUND TRUE)
   SET(MKL_LAPACK_LIBRARIES ${MKL_NUM_LIB} 
                            ${MKL_THREAD_LIB}
 			   ${MKL_CORE_LIB} 
+                           ${MKL_GOMP_LIB}
                            ${MKL_PTHREAD_LIB}
                            ${MKL_M_LIB}  CACHE FILEPATH "MKL LAPACK")
   SET(MKL_LAPACK_LIBRARIES_FOUND TRUE)
@@ -181,6 +185,7 @@
                                 ${MKL_THREAD_LIB}
                                 ${MKL_CORE_LIB} 
 				${MKL_BLACS_LIB}
+                ${MKL_GOMP_LIB}
 				${MKL_PTHREAD_LIB}
                                 ${MKL_M_LIB} CACHE FILEPATH "MKL SCALAPACK libraries")
     SET(MKL_SCALAPACK_LIBRARIES_FOUND TRUE)
@@ -219,6 +224,7 @@
 UNSET(MKL_CORE_LIB_NAME)
 UNSET(MKL_NUM_LIB_NAME)
 UNSET(MKL_THREAD_LIB_NAME)
+UNSET(MKL_GOMP_LIB_NAME)
 UNSET(MKL_PTHREAD_LIB_NAME)
 UNSET(MKL_M_LIB_NAME)
 UNSET(MKL_FAILMSG)
@@ -249,6 +255,7 @@
   MKL_NUM_LIB
   MKL_CORE_LIB
   MKL_THREAD_LIB
+  MKL_GOMP_LIB
   MKL_PTHREAD_LIB
   MKL_M_LIB
   MKL_BLACS_LIB
